{"version":3,"sources":["components/score/ResultCell.tsx","components/score/index.tsx","pages/reading/article/index.tsx","components/inventory/index.tsx","pages/reading/index.tsx","components/speaker/index.tsx","components/speaker/assets/face.png","components/book/assets/face.png","components/book/index.tsx","pages/choice/index.tsx","pages/home/FriendLinks.tsx","pages/home/Home.tsx","pages/guide/assets/guide-man.png","pages/guide/Guide.tsx","pages/main/assets/robot.svg","pages/main/chat/index.tsx","pages/main/assets/avatar-1.png","pages/main/Main.tsx","components/item/assets/star_yellow.png","components/item/index.tsx","components/dialog/index.tsx","App.tsx","store/models/valueState.ts","reportWebVitals.ts","store/models/uiState.ts","store/models/bookState.ts","store/models/index.ts","store/store.ts","index.tsx"],"names":["ResultCell","styled","div","Row","Icon","img","Text","span","ResultProgress","progress","functionResultCell","name","value","className","max","Panel","ScorePanel","scores","useSelector","state","valueState","Object","keys","map","key","Article","content","nextPage","dispatch","useDispatch","useEffect","metadata","forEach","updatePayload","undefined","score","scoreDiff","realValue","checkItemAffectValues","updateScore","item","insertUpdateInventory","onClick","Container","Cell","Item","InventoryBar","inventory","uiState","inspectItem","Content","DetailedReading","history","useHistory","bookState","currentDetailedReadContent","bookComments","currentBookComment","itemComments","currentItemComment","detailedReadRound","currentDetailedReadRound","useState","detailedReadEnd","detailedReadEndSetter","page","setPage","onNextPage","useCallback","currentItemCommentSetter","length","readEndText","flatMap","line","text","join","selectGameEnding","replace","updateCurrentDetailedReadRound","DetailedReadingGuide","src","onChoose","books","currentDetailedTemplateNames","loadAvailableDetailedTemplates","onChooseBook","a","startNewDetailedRead","push","book","FriendLinkRow","Title","h3","Name","FriendLinks","target","href","rel","Button","button","Home","to","GuiderImage","ScrollBox","section","props","left","GuiderText","guideText","index","linkTo","Guide","loadGuideText","loadItemDefinitions","updateDetailedReadRound","loadEndingDefinitions","clearScore","clearInventory","setActivatedInventory","closeInventoryInspectDialog","currentBookCommentSetter","End","currentEnding","description","SectionList","Message","Balloon","BalloonContent","direction","Avatar","mirror","ChatLeft","message","robotAvatar","ChatRight","SkimThroughReadChat","currentSkimThroughReadContent","skimThroughReadInterval","currentSkimThroughChat","currentSkimThroughChatSetter","skimThroughEnd","skimThroughEndSetter","fn","startNewSkimThroughRead","scrollBottomRef","useRef","oldContents","dropRight","newContent","takeRight","nextSkimThroughChat","object","timeoutHandle","setTimeout","nextSkimThroughChat2","clearTimeout","current","scrollIntoView","behavior","bookDescription","id","ref","Main","Thumb","minus","ItemDescription","effects","alt","effect","effectTo","Array","from","_","StarYellow","effectFrom","Dialog","dialog","Menu","Mask","active","ItemInspectDialog","itemToInspect","itemDefinitions","open","inventoryOpen","e","stopPropagation","App","ItemEffect","path","exact","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","createModel","currentScenario","scenarios","reducers","guideTextSetter","itemID","payload","rootState","fetch","response","newGuideTextContent","split","parsedCddaJSONWithNameAndDescription","JSON","parse","cddaJSONWithNameAndDescription","skimThroughReadCountRange","detailedReadWithScoreFrequency","detailedReadWithItemFrequency","detailedReadRoundConfig","newScoreRange","currentDetailedReadTemplate","detailedTemplateMenu","updateDetailedTemplateMenu","newMenu","min","random","updateCurrentDetailedTemplateNames","newTemplateNames","clearSkimThroughReadingContent","appendSkimThroughReadingContent","newSkimThroughReadingContent","clearDetailedReadingContent","updateDetailedReadingContent","newDetailedReadingContent","updateBookComments","newBookComments","counter","randomBook","sample","Promise","resolve","console","error","count","detailedTemplateMenuContent","newDetailedTemplateNames","sampleSize","newDetailedTemplateName","newDetailedTemplateContent","vFile","VFile","newErrorMessage","templateData","templateFileToNLCSTNodes","configFormData","Error","result","randomOutlineToArrayWithMetadataCompiler","scoreIDs","itemIDs","resultWithRandomMetadata","aResult","metadataItem","randomScoreID","randomItemID","haveScore","haveItem","randomScoreValue","warn","loadCurrentBookComment","templateName","json","newBookCommentContent","资源","威胁","道德","activatedInventory","endingDefinitions","newValue","insertInventory","newItemID","newActivatedInventory","updateItemDefinitions","newItemDefinitions","updateEndingDefinitions","newEndingDefinitions","updateCurrentEnding","newCurrentEnding","newItemDefinitionsList","newEndingList","cloneDeep","itemDefinition","增加","反转","转移","info","ending","condition","every","itemName","comment","models","store","init","plugins","immerPlugin","loadingPlugin","ReactDOM","render","StrictMode","document","querySelector"],"mappings":"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","file":"static/js/main.2f03a89b.chunk.js","sourcesContent":["import styled from 'styled-components';\n\nconst ResultCell = styled.div`\n  display: flex;\n  justify-content: center;\n  flex-wrap: wrap;\n  flex-direction: column;\n  width: 90px;\n`;\n\nconst Row = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n`;\n\nconst Icon = styled.img`\n  width: 35px;\n  height: 35px;\n  object-fit: contain;\n  background-color: #4f4f4f;\n`;\n\nconst Text = styled.span`\n  display: block;\n  font-size: 20px;\n`;\n\nconst ResultProgress = styled.progress`\n  height: 18px;\n  margin: 0;\n`;\n\ninterface ResultCellProps {\n  name: string;\n  value: number;\n}\n\nexport default function functionResultCell({ name, value = 0 }: ResultCellProps): JSX.Element {\n  return (\n    <ResultCell>\n      <Row>\n        <Icon />\n        <Text>{name}</Text>\n      </Row>\n      <ResultProgress className=\"nes-progress\" value={value} max=\"10\"></ResultProgress>\n    </ResultCell>\n  );\n}\n","import styled from 'styled-components';\nimport { useSelector } from 'react-redux';\nimport { RootState } from 'src/store/store';\n\nimport ResultCell from './ResultCell';\n\nconst Panel = styled.div`\n  display: flex;\n  justify-content: space-between;\n  padding: 25px;\n  width: 100%;\n  background-color: #c4c4c4;\n`;\n\nexport function ScorePanel(): JSX.Element {\n  const scores = useSelector((state: RootState) => state.valueState.scores);\n  return (\n    <Panel>\n      {Object.keys(scores).map((key: string) => (\n        <ResultCell name={key} key={key} value={scores[key]} />\n      ))}\n    </Panel>\n  );\n}\n","import { useEffect } from 'react';\nimport styled from 'styled-components';\nimport { useDispatch } from 'react-redux';\n\nimport type { IOutputWIthMetadata } from 'tbg';\nimport type { IBookTextMetadata, IBookTextNewItemMetadata, IBookTextUpdateGameScoreMetadata } from 'src/store/models/bookState';\nimport { Dispatch } from 'src/store/store';\n\nconst Article = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 350px;\n  margin: 0 auto;\n`;\n\ninterface ArticleProps {\n  content: IOutputWIthMetadata<IBookTextMetadata[]>;\n  nextPage: () => void;\n}\n\nexport default ({ content, nextPage }: ArticleProps) => {\n  const dispatch = useDispatch<Dispatch>();\n  useEffect(() => {\n    content.metadata?.forEach?.((updatePayload) => {\n      if (updatePayload !== undefined) {\n        const { score, scoreDiff } = updatePayload as IBookTextUpdateGameScoreMetadata;\n        if (score && scoreDiff) {\n          const realValue = dispatch.valueState.checkItemAffectValues({ score, scoreDiff });\n          dispatch.valueState.updateScore(realValue.score, realValue.scoreDiff);\n        }\n        const { item } = updatePayload as IBookTextNewItemMetadata;\n        if (item) {\n          dispatch.valueState.insertUpdateInventory(item);\n        }\n      }\n    })\n  }, [content]);\n  return (\n    <Article className=\"nes-container is-dark is-rounded\" onClick={nextPage}>\n      <p>{content.value}</p>\n    </Article>\n  );\n};\n","import styled from 'styled-components';\nimport { Tooltip2 } from '@blueprintjs/popover2';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Dispatch, RootState } from 'src/store/store';\n\nconst Container = styled.div`\n  display: flex;\n  justify-content: space-between;\n  padding: 25px;\n  width: 100%;\n  background-color: #c4c4c4;\n  flex-wrap: wrap;\n`;\n\nconst Cell = styled.div`\n  height: 62px;\n  width: 62px;\n  margin: 8px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst Item = styled.div`\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  background-color: #4f4f4f;\n  color: white;\n`;\n\nexport function InventoryBar(): JSX.Element {\n  const inventory = useSelector((state: RootState) => state.valueState.inventory);\n  const dispatch = useDispatch<Dispatch>();\n  return (\n    <Container>\n      {inventory.map((item) => (\n        <Cell key={item} onClick={() => dispatch.uiState.inspectItem(item)}>\n          <Tooltip2 content={`查看${item}`}>\n            <Item>{item[0]}</Item>\n          </Tooltip2>\n        </Cell>\n      ))}\n    </Container>\n  );\n}\n","import { useState, useEffect, useCallback } from 'react';\nimport styled from 'styled-components';\nimport { useHistory } from 'react-router-dom';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Dispatch, RootState } from 'src/store/store';\nimport { ScorePanel } from '../../components/score';\nimport Article from './article';\nimport { InventoryBar } from 'src/components/inventory';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  height: 100%;\n  width: 100%;\n`;\n\nconst Content = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  width: 100%;\n  overflow: scroll;\n`;\n\nexport default function DetailedReading(): JSX.Element {\n  const history = useHistory();\n  const content = useSelector((state: RootState) => state.bookState.currentDetailedReadContent);\n  const bookComments = useSelector((state: RootState) => state.uiState.currentBookComment);\n  const itemComments = useSelector((state: RootState) => state.uiState.currentItemComment);\n  const detailedReadRound = useSelector((state: RootState) => state.bookState.detailedReadRound);\n  const currentDetailedReadRound = useSelector((state: RootState) => state.bookState.currentDetailedReadRound);\n  const dispatch = useDispatch<Dispatch>();\n  const [detailedReadEnd, detailedReadEndSetter] = useState<boolean>(false);\n\n  const [page, setPage] = useState(0);\n  useEffect(() => {\n    setPage(0);\n  }, [content]);\n\n  const onNextPage = useCallback((): void => {\n    dispatch.uiState.currentItemCommentSetter('');\n    if (page < content.length - 1) {\n      setPage(page + 1);\n    } else {\n      // 先展示当前阅读结论\n      detailedReadEndSetter(true);\n    }\n  }, [currentDetailedReadRound, detailedReadRound, page, setPage, detailedReadEndSetter]);\n  const readEndText = content\n    .flatMap((line) =>\n      (line.metadata ?? []).map((metadata) => {\n        let text = bookComments;\n        if ('item' in metadata) {\n          text += `获得了「${metadata.item}」。`;\n        }\n        if ('score' in metadata) {\n          text += `「${metadata.score}」得重新评估了。`;\n        }\n        return text;\n      }),\n    )\n    .join('\\n');\n  return (\n    <Container>\n      <ScorePanel />\n      {detailedReadEnd ? (\n        <Content>\n          {content[page] !== undefined && (\n            <Article\n              content={{ value: readEndText, metadata: [] }}\n              nextPage={() => {\n                // end reading\n                // 判断是不是已经读够了\n                if (currentDetailedReadRound >= detailedReadRound) {\n                  // 是的话就进入结束界面\n                  dispatch.valueState.selectGameEnding({});\n                  history.replace('/ending');\n                } else {\n                  // 否则就继续读，\n                  dispatch.bookState.updateCurrentDetailedReadRound(currentDetailedReadRound + 1);\n                  // 跳回略读界面\n                  history.replace('/main');\n                }\n              }}\n            />\n          )}\n        </Content>\n      ) : (\n        <Content>{content[page] !== undefined && <Article content={content[page]} nextPage={onNextPage} />}</Content>\n      )}\n      <div>{itemComments}</div>\n      <InventoryBar />\n    </Container>\n  );\n}\n","import React, { useState } from 'react';\nimport styled from 'styled-components';\nimport Face from './assets/face.png';\n\nconst Container = styled.div`\n  width: 100%;\n  padding: 25px;\n  max-height: 350px;\n  text-align: right;\n\n  .avatar {\n    height: 55px;\n    width: 55px;\n    object-fit: contain;\n    border-radius: 50%;\n    background-color: #e6bd09;\n  }\n`;\n\nexport function DetailedReadingGuide(): JSX.Element {\n  return (\n    <Container>\n      <section className=\"message -right\">\n        <div className=\"nes-balloon from-right\">\n          <p>选择一本书仔细研读。</p>\n        </div>\n      </section>\n      <img className=\"avatar\" src={Face} />\n    </Container>\n  );\n}\n","export default \"data:image/png;base64,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\"","export default \"data:image/png;base64,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\"","import React, { useState } from 'react';\nimport styled from 'styled-components';\nimport Face from './assets/face.png';\n\nconst Container = styled.div`\n  width: 150px;\n  height: 220px;\n  padding: 25px;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  align-items: center;\n  background-color: #c4c4c4;\n  margin: 16px;\n\n  .cover {\n    width: 60px;\n    height: 70px;\n    object-fit: contain;\n  }\n\n  h1 {\n    margin: 0;\n    padding: 0;\n    font-size: 14px;\n    font-weight: 800;\n  }\n\n  p {\n    margin: 0;\n    padding: 0;\n    font-size: 14px;\n  }\n`;\n\ninterface BookProps {\n  name: string;\n  onChoose: (name: string) => void;\n}\n\nexport default ({ name, onChoose }: BookProps) => {\n  const onClick = () => {\n    onChoose(name);\n  };\n  return (\n    <Container onClick={onClick}>\n      <img className=\"cover\" src={Face} />\n      <h1>{name}</h1>\n      <p>---</p>\n    </Container>\n  );\n};\n","import { useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Dispatch, RootState } from 'src/store/store';\nimport styled from 'styled-components';\nimport { DetailedReadingGuide } from '../../components/speaker';\nimport Book from '../../components/book';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  height: 100%;\n  width: 100%;\n\n  .bookList {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-wrap: wrap;\n  }\n`;\n\nexport default (): JSX.Element => {\n  const history = useHistory();\n  const books = useSelector((state: RootState) => state.bookState.currentDetailedTemplateNames);\n\n  const dispatch = useDispatch<Dispatch>();\n  useEffect(() => {\n    dispatch.bookState.loadAvailableDetailedTemplates(3);\n  }, []);\n\n  const onChooseBook = async (name: string) => {\n    await dispatch.bookState.startNewDetailedRead(name);\n    history.push('/reading');\n  };\n\n  return (\n    <Container>\n      <div className=\"bookList\">\n        {books.map((book) => (\n          <Book key={book} name={book} onChoose={onChooseBook} />\n        ))}\n      </div>\n      <DetailedReadingGuide />\n    </Container>\n  );\n};\n","import styled from 'styled-components';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  height: auto;\n  width: 100%;\n  padding: 20px;\n  &,\n  & * {\n    font-family: unset;\n    font-size: 14px;\n  }\n`;\nconst FriendLinkRow = styled.span`\n  display: flex;\n  width: 100%;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  a {\n    margin-right: 20px;\n  }\n`;\nconst Title = styled.h3``;\nconst Name = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`;\n\nexport function FriendLinks(): JSX.Element {\n  return (\n    <Container>\n      <Title>感谢</Title>\n      <span>开发组：</span>\n      <FriendLinkRow>\n        <Name>\n          主催 / AI\n          <a target=\"_blank\" href=\"https://github.com/linonetwo\" rel=\"noreferrer\">\n            林一二\n          </a>\n        </Name>\n        <Name>\n          文案 / 策划\n          <a target=\"_blank\" href=\"\">\n            李子申\n          </a>\n        </Name>\n        <Name>\n          UI设计 / 前端\n          <a target=\"_blank\" href=\"https://github.com/Here21\" rel=\"noreferrer\">\n            张灏哲\n          </a>\n        </Name>\n      </FriendLinkRow>\n      <span>项目核心引擎：基于模板的「基于模板的文本自动生成器」自动生成器！（在本次Hackathon内开发！）</span>\n      <FriendLinkRow>\n        <a target=\"_blank\" href=\"https://github.com/linonetwo/template-based-generator-template\" rel=\"noreferrer\">\n          Github Template\n        </a>\n        <a target=\"_blank\" href=\"https://onetwo.ren/template-based-generator-template/\" rel=\"noreferrer\">\n          在线试玩\n        </a>\n      </FriendLinkRow>\n\n      <span>我们使用了基于 CC BY-SA 3.0 协议的 CDDA 游戏知识图谱！在此希望更多人入坑！</span>\n      <FriendLinkRow>\n        <a target=\"_blank\" href=\"cataclysmdda.org/\">\n          官网\n        </a>\n        <a target=\"_blank\" href=\"https://github.com/CleverRaven/Cataclysm-DDA/releases/latest\" rel=\"noreferrer\">\n          官方Github\n        </a>\n        <a target=\"_blank\" href=\"https://cdda.fun/\" rel=\"noreferrer\">\n          中文社区\n        </a>\n        <a target=\"_blank\" href=\"https://github.com/linonetwo/CDDA-Kenan-Modpack-Chinese\" rel=\"noreferrer\">\n          社区图谱包\n        </a>\n      </FriendLinkRow>\n    </Container>\n  );\n}\n","import { useDispatch } from 'react-redux';\nimport styled from 'styled-components';\nimport { Link } from 'react-router-dom';\nimport { FriendLinks } from './FriendLinks';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  align-items: center;\n  height: 100%;\n  width: 100%;\n`;\nconst Button = styled.button``;\n\nexport function Home(): JSX.Element {\n  return (\n    <Container>\n      <Link to=\"/guide\">\n        <Button className=\"nes-btn is-primary\">开始探索</Button>\n      </Link>\n      <FriendLinks />\n    </Container>\n  );\n}\n","export default \"data:image/png;base64,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\"","import { useEffect, useCallback } from 'react';\nimport { useHistory } from 'react-router';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { RootState, Dispatch } from 'src/store/store';\nimport styled from 'styled-components';\nimport Guider from './assets/guide-man.png';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  height: 100%;\n  width: 100%;\n`;\n\nconst GuiderImage = styled.img`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n`;\n\nconst ScrollBox = styled.section`\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  overflow: scroll;\n  &::-webkit-scrollbar {\n    width: 0;\n  }\n  margin-bottom: 200px;\n`;\n\ninterface MessageBoxProps {\n  left?: boolean;\n}\n\nconst MessageBox = styled.div<MessageBoxProps>`\n  width: 315px;\n  background-color: #c4c4c4;\n  display: flex;\n  align-items: center;\n  justify-content: ${(props) => (props.left ? 'flex-start' : 'flex-end')};\n`;\n\nexport function GuiderText(props: { guideText: string[]; linkTo: string }): JSX.Element {\n  return (\n    <Container className=\"nes-container\">\n      <ScrollBox className=\"message-list\">\n        {props.guideText.map((text, index) => (\n          <section className={`message ${index % 2 === 0 ? '-left' : '-right'}`}>\n            <div className={`nes-balloon from${index % 2 === 0 ? '-left' : '-right'}`}>\n              <p>{text}</p>\n            </div>\n          </section>\n        ))}\n      </ScrollBox>\n      <Link to={props.linkTo}>\n        <GuiderImage src={Guider} />\n      </Link>\n    </Container>\n  );\n}\n\nexport function Guide(): JSX.Element {\n  const guideText = useSelector((state: RootState) => state.uiState.guideText);\n  const dispatch = useDispatch<Dispatch>();\n  useEffect(() => {\n    dispatch.uiState.loadGuideText({});\n    dispatch.valueState.loadItemDefinitions({});\n    dispatch.bookState.updateDetailedReadRound();\n    dispatch.valueState.loadEndingDefinitions({});\n    dispatch.valueState.clearScore();\n    dispatch.valueState.clearInventory();\n    dispatch.valueState.setActivatedInventory([]);\n    dispatch.uiState.closeInventoryInspectDialog();\n    dispatch.uiState.currentBookCommentSetter('');\n  }, []);\n  return <GuiderText guideText={guideText} linkTo=\"/main\" />;\n}\n\nexport function End(): JSX.Element {\n  const currentEnding = useSelector((state: RootState) => state.valueState.currentEnding);\n  const history = useHistory();\n  return currentEnding !== undefined ? (\n    <GuiderText guideText={[currentEnding.name, currentEnding.description]} linkTo=\"/\" />\n  ) : (\n    <GuiderText guideText={['游戏结束，结局计算出了Bug，兜底已试行但未生效…']} linkTo=\"/\" />\n  );\n}\n","export default __webpack_public_path__ + \"static/media/robot.c4d90092.svg\";","import { dropRight, takeRight } from 'lodash';\nimport { useEffect, useRef, useState } from 'react';\nimport { useHistory } from 'react-router';\nimport { useSelector, useDispatch } from 'react-redux';\nimport styled from 'styled-components';\nimport { Dispatch, RootState } from 'src/store/store';\nimport avatar1 from '../assets/avatar-1.png';\nimport robotAvatar from '../assets/robot.svg';\n\nconst SectionList = styled.section`\n  padding: 16px;\n  height: 100%;\n  overflow-y: scroll;\n  scroll-behavior: smooth;\n`;\n\nconst Message = styled.section`\n  display: flex;\n`;\n\nconst Balloon = styled.div`\n  flex: 1;\n`;\n\ninterface BalloonContentProps {\n  direction: 'left' | 'right';\n}\n\nconst BalloonContent = styled.div<BalloonContentProps>`\n  flex: 1;\n  text-align: ${(props) => props.direction};\n`;\n\nconst Avatar = styled.img<{ mirror?: boolean }>`\n  width: 56px;\n  height: 56px;\n  flex-shrink: 0;\n  ${({ mirror }) => mirror && `transform: rotateY(180deg);`}\n`;\n\nfunction ChatLeft(props: { message: string; onClick?: () => void }) {\n  return (\n    <Message className=\"message -left\" onClick={props.onClick}>\n      <Balloon className=\"nes-balloon from-left\">\n        <BalloonContent direction=\"left\">\n          <p>这本书里面提到{props.message}</p>\n          <Avatar src={robotAvatar} />\n        </BalloonContent>\n      </Balloon>\n    </Message>\n  );\n}\nfunction ChatRight(props: { message: string }) {\n  return (\n    <Message className=\"message -right\">\n      <Balloon className=\"nes-balloon from-right\">\n        <BalloonContent direction=\"right\">\n          <p>我对它写的{props.message}没什么兴趣</p>\n          <Avatar src={avatar1} mirror />\n        </BalloonContent>\n      </Balloon>\n    </Message>\n  );\n}\n\nexport function SkimThroughReadChat(): JSX.Element {\n  const history = useHistory();\n  const currentSkimThroughReadContent = useSelector((state: RootState) => state.bookState.currentSkimThroughReadContent);\n  const skimThroughReadInterval = useSelector((state: RootState) => state.bookState.skimThroughReadInterval);\n  const [currentSkimThroughChat, currentSkimThroughChatSetter] = useState<string[]>([]);\n  const [skimThroughEnd, skimThroughEndSetter] = useState<boolean>(false);\n  const dispatch = useDispatch<Dispatch>();\n  useEffect(() => {\n    const fn = async () => {\n      await dispatch.bookState.startNewSkimThroughRead({});\n      skimThroughEndSetter(true);\n    };\n    fn();\n  }, []);\n\n  const scrollBottomRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const oldContents = dropRight(currentSkimThroughReadContent);\n    const newContent = takeRight(currentSkimThroughReadContent);\n    let nextSkimThroughChat: string[] = [];\n    if (currentSkimThroughReadContent.length > 1) {\n      nextSkimThroughChat = [...oldContents.flatMap((object) => [object.description, object.name]), newContent[0].description];\n    } else if (currentSkimThroughReadContent.length === 1) {\n      nextSkimThroughChat = currentSkimThroughReadContent.flatMap((object) => [object.description]);\n    } else {\n      return;\n    }\n\n    currentSkimThroughChatSetter(nextSkimThroughChat);\n\n    const timeoutHandle = setTimeout(() => {\n      let nextSkimThroughChat2: string[] = [];\n      if (currentSkimThroughReadContent.length >= 1) {\n        nextSkimThroughChat2 = [...nextSkimThroughChat, newContent[0].name];\n      } else {\n        return;\n      }\n      currentSkimThroughChatSetter(nextSkimThroughChat2);\n    }, skimThroughReadInterval / 2);\n    return () => clearTimeout(timeoutHandle);\n  }, [currentSkimThroughReadContent]);\n\n  useEffect(() => {\n    scrollBottomRef.current?.scrollIntoView?.({ behavior: 'smooth' });\n  });\n\n  return (\n    <SectionList className=\"message-list\">\n      {currentSkimThroughChat.map((bookDescription, index) =>\n        index % 2 === 0 ? <ChatLeft key={bookDescription} message={bookDescription} /> : <ChatRight key={bookDescription} message={bookDescription} />,\n      )}\n      {skimThroughEnd && (\n        <ChatLeft\n          message=\"......好多内容！这里！终于找到一本有价值的书了，在这本旁边好像有人还整理了几本也被翻阅得很旧的书放在一起。（点击此对话泡，进入精读界面）\"\n          onClick={() => {\n            history.push('/choice');\n          }}\n        />\n      )}\n      <div id=\"section-scroll-bottom-anchor\" ref={scrollBottomRef} />\n    </SectionList>\n  );\n}\n","export default \"data:image/png;base64,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\"","import styled from 'styled-components';\nimport { ScorePanel } from '../../components/score';\nimport { SkimThroughReadChat } from './chat';\nimport { InventoryBar } from '../../components/inventory';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n`;\n\nexport function Main(): JSX.Element {\n  return (\n    <Container>\n      <ScorePanel />\n      <SkimThroughReadChat />\n      <InventoryBar />\n    </Container>\n  );\n}\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADeSURBVHgB7djvDYIwEAXwp3EB/c4MbsEahR0YwyFuDsZxAUeoNZGkURpKjgspfb/kvhUN93r8A4iIiOxIKB+qg5EzaJaE8jI03o9337XXTwomSRSfAE/gaATR3v8ti1ngFtpb8SdwylwnodzioqGBa29Ly9A/npDxhQz997+TDp+AhHK5nd1alFQyiTpnwCqRmdngDKQINpyNnL2eUm0CE4EiCU3nJ3yU2BuvQrwKKV1gIPW0aXEHr+6dWKB759Ue/6fuBKKOre2cxMdpvuDVmQDWd9zsd/lljoiIivYGQ12hvMIiM18AAAAASUVORK5CYII=\"","import React from 'react';\nimport { IItem } from 'src/store/models/valueState';\nimport styled from 'styled-components';\nimport StarYellow from './assets/star_yellow.png';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  .row {\n    display: flex;\n    margin-bottom: 20px;\n    align-items: center;\n  }\n  .row-inline {\n    display: flex;\n    align-items: center;\n  }\n  .column {\n    display: flex;\n    flex-direction: column;\n  }\n  .cover {\n    height: 86px;\n    width: 86px;\n    background-color: #000;\n  }\n\n  .thumb {\n    height: 25px;\n    width: 25px;\n  }\n`;\n\nconst Thumb = styled.img<{ minus?: boolean }>`\n  ${({ minus }) => minus === true && `background-color: black;`}\n`;\n\nexport function ItemDescription(props: { item: IItem }): JSX.Element {\n  const { id, description, effects } = props.item;\n  return (\n    <Container>\n      <div className=\"row\">\n        <img className=\"cover\" src=\"\" alt=\"\" />\n        <div className=\"column\">\n          <p>名称</p>\n          <p>{id}</p>\n        </div>\n      </div>\n      <div className=\"row\">{description}</div>\n      影响\n      {effects.map((effect) => (\n        <>\n          {effect.effectTo !== undefined && (\n            <div className=\"row-inline\">\n              {effect.effectTo}\n              <div className=\"row-inline\">\n                {Array.from({ length: effect.value }).map((_, index) => (\n                  <Thumb key={index} className=\"thumb\" src={StarYellow} />\n                ))}\n                {effect.value < 0 && <Thumb minus className=\"thumb\" src={StarYellow} />}\n              </div>\n            </div>\n          )}\n          {effect.effectFrom !== undefined && (\n            <div className=\"row-inline\">\n              {effect.effectFrom}\n              <div className=\"row-inline\">\n                <Thumb minus className=\"thumb\" src={StarYellow} />\n              </div>\n            </div>\n          )}\n        </>\n      ))}\n    </Container>\n  );\n}\n","import { useCallback } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Dispatch, RootState } from 'src/store/store';\nimport styled from 'styled-components';\n\nimport { ItemDescription } from 'src/components/item';\n\ninterface MaskProps {\n  active: boolean;\n}\n\ninterface DialogProps {\n  active: boolean;\n  onClose: () => void;\n  children?: JSX.Element;\n}\n\nconst Dialog = styled.dialog`\n  z-index: 100;\n  margin: 20px;\n  max-height: 650px;\n  width: 350px;\n  ::backdrop {\n    background: rgba(0, 0, 0, 0.25);\n  }\n`;\n\nconst Menu = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\n\nconst Content = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst Body = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n  height: 100%;\n  max-height: 480px;\n  margin-bottom: 16px;\n  overflow-y: scroll;\n  overflow-x: hidden;\n`;\n\nconst Mask = styled.div<MaskProps>`\n  display: ${(props) => (props.active ? 'flex' : 'none')};\n  overflow: hidden;\n  z-index: 99;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.45);\n  align-items: center;\n  justify-content: center;\n`;\n\nexport function ItemInspectDialog(): JSX.Element {\n  const item = useSelector((state: RootState) => state.uiState.itemToInspect && state.valueState.itemDefinitions[state.uiState.itemToInspect]);\n  const open = useSelector((state: RootState) => state.uiState.inventoryOpen);\n  const dispatch = useDispatch<Dispatch>();\n  const onClick = useCallback((): void => {\n    dispatch.uiState.closeInventoryInspectDialog();\n  }, []);\n  return (\n    <Mask active={open} onClick={onClick}>\n      <Dialog open={open} className=\"nes-dialog is-rounded\" onClick={(e) => e.stopPropagation()}>\n        <Content>\n          {item && <ItemDescription item={item} />}\n          <Menu className=\"dialog-menu\">\n            <button className=\"nes-btn\" onClick={onClick}>\n              关闭\n            </button>\n          </Menu>\n        </Content>\n      </Dialog>\n    </Mask>\n  );\n}\n","import React from 'react';\nimport styled from 'styled-components';\nimport { MemoryRouter as Router, Switch, Route } from 'react-router-dom';\nimport './style.css';\nimport 'nes.css/css/nes.min.css';\n\nimport ReadingPage from './pages/reading';\nimport ChoicePage from './pages/choice';\nimport { Home } from './pages/home/Home';\nimport { End, Guide } from './pages/guide/Guide';\nimport { Main } from './pages/main/Main';\n\nimport { ItemInspectDialog } from 'src/components/dialog';\n\nconst Container = styled.div`\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  overflow: hidden;\n`;\n\nfunction App(): JSX.Element {\n  return (\n    <Container>\n      <Router>\n        <Switch>\n          <Route path=\"/main\" exact>\n            <Main />\n          </Route>\n          <Route path=\"/guide\" exact>\n            <Guide />\n          </Route>\n          <Route path=\"/ending\" exact>\n            <End />\n          </Route>\n          <Route path=\"/reading\" exact>\n            <ReadingPage />\n          </Route>\n          <Route path=\"/choice\" exact>\n            <ChoicePage />\n          </Route>\n          <Route path=\"/\" exact>\n            <Home />\n          </Route>\n        </Switch>\n      </Router>\n      <ItemInspectDialog />\n    </Container>\n  );\n}\n\nexport default App;\n","/* eslint-disable typescript-sort-keys/interface */\n/* eslint-disable @typescript-eslint/consistent-type-assertions */\nimport { cloneDeep } from 'lodash';\nimport { createModel } from '@rematch/core';\nimport type { IBookTextUpdateGameScoreMetadata } from './bookState';\nimport type { RootModel } from './index';\n\nexport enum ItemEffect {\n  增加,\n  转移,\n  反转,\n}\nexport interface IItemEffect {\n  /**\n   * 仅转移时有用，作为转移的源头\n   */\n  effectFrom?: string;\n  /**\n   * 转移的时候作为转移的目的地；其余时候作为效果的目标\n   */\n  effectTo?: string;\n  /**\n   * 物品效果，描述了 value 字段的解释方法\n   */\n  effect: ItemEffect;\n  /**\n   * 一个数值，涵义根据 effect 不同而不同\n   */\n  value: number;\n}\nexport interface IItem {\n  /**\n   * 其实也是 name，索引和展示用\n   */\n  id: string;\n  /**\n   * 物品描述文案\n   */\n  description: string;\n  /**\n   * 对物品的吐槽描述\n   */\n  comment: string;\n  /**\n   * 物品的效果计算数值等\n   */\n  effects: IItemEffect[];\n}\nexport interface IEnding {\n  /**\n   * 其实也是 id，索引和展示用\n   */\n  name: string;\n  /**\n   * 展示给用户的结局文案\n   */\n  description: string;\n  /**\n   * ```json\n   * \"condition\": {\n      \"资源\": \"5\",\n      \"威胁\": \"5\",\n      \"道德\": \"5\"\n    }\n    ```\n   */\n  condition: Record<string, number>;\n}\nexport type IItemDefinition = Record<string, IItem | undefined>;\ninterface IValueState {\n  /**\n   * 当前的计分板，可以分为多个维度，例如「资源，威胁，道德」，各自有自己的得分\n   * 同时这个字段的 key 也作为 score 的 schema 使用，可以 Object.keys 后用于得知有哪几个 score 维度\n   */\n  scores: Record<string, number>;\n  /**\n   * 当前持有的物品 ID 列表\n   */\n  inventory: string[];\n  /**\n   * 当前局激活的物品 ID 列表\n   */\n  activatedInventory: string[];\n  /**\n   * 加载的策划填的物品定义表\n   */\n  itemDefinitions: IItemDefinition;\n  /**\n   * 结局的定义\n   */\n  endingDefinitions: IEnding[];\n  /**\n   * 当前的结局，需要通过调用 selectGameEnding 来更新\n   */\n  currentEnding: IEnding | undefined;\n}\n\n/**\n * 管理当前在读的书的状态\n */\nexport const valueState = createModel<RootModel>()({\n  state: {\n    scores: {\n      资源: 0,\n      威胁: 0,\n      道德: 0,\n    },\n    inventory: [],\n    activatedInventory: [],\n    itemDefinitions: {},\n    endingDefinitions: [],\n    currentEnding: undefined,\n  } as IValueState,\n  reducers: {\n    /**\n     * 更新计分板中的一个维度\n     * @param type keyof typeof scores，例如 `\"威胁\"`\n     * @param newValue 新的值，将直接设进去。需要在 react 侧在旧值上累加后设过来\n     */\n    updateScore(state, score: string, newValue: number) {\n      state.scores[score] = newValue;\n      return state;\n    },\n    clearScore(state) {\n      state.scores = {\n        资源: 0,\n        威胁: 0,\n        道德: 0,\n      };\n      return state;\n    },\n    /**\n     * 玩家新获得道具时，调用这个放入物品栏\n     * @param 玩家新获得的物品的 ID\n     * @returns\n     */\n    insertInventory(state, newItemID: string) {\n      state.inventory.push(newItemID);\n      return state;\n    },\n    clearInventory(state) {\n      state.inventory = [];\n      return state;\n    },\n    /**\n     * 设置哪些物品是启用了的。此方法也可以用于清空启用的物品列表。\n     * @param newActivatedInventory 物品 ID 列表，或空列表\n     * @returns\n     */\n    setActivatedInventory(state, newActivatedInventory: string[]) {\n      state.activatedInventory = newActivatedInventory;\n      return state;\n    },\n    updateItemDefinitions(state, newItemDefinitions: IItemDefinition) {\n      state.itemDefinitions = newItemDefinitions;\n      return state;\n    },\n    updateEndingDefinitions(state, newEndingDefinitions: IEnding[]) {\n      state.endingDefinitions = newEndingDefinitions;\n      return state;\n    },\n    updateCurrentEnding(state, newCurrentEnding: IEnding) {\n      state.currentEnding = newCurrentEnding;\n      return state;\n    },\n  },\n  effects: (dispatch) => ({\n    async loadItemDefinitions(payload, rootState) {\n      const currentScenario = rootState.uiState.currentScenario;\n      const newItemDefinitionsList = await fetch(`data/${currentScenario}/items.json`).then(async (response) => await (response.json() as Promise<IItem[]>));\n      const newItemDefinitions: IItemDefinition = {};\n      newItemDefinitionsList.forEach((item) => {\n        newItemDefinitions[item.id] = item;\n      });\n      dispatch.valueState.updateItemDefinitions(newItemDefinitions);\n    },\n    async loadEndingDefinitions(payload, rootState) {\n      const currentScenario = rootState.uiState.currentScenario;\n      const newEndingList = await fetch(`data/${currentScenario}/ending.json`).then(async (response) => await (response.json() as Promise<IEnding[]>));\n      dispatch.valueState.updateEndingDefinitions(newEndingList);\n    },\n    /**\n     * 检测玩家物品栏，看看是不是有影响数值计算的物品在，返回计算得到的真实数值\n     * @param payload 本次参与计算的数值和类型\n     */\n    checkItemAffectValues(payload: IBookTextUpdateGameScoreMetadata, rootState) {\n      const realValue = cloneDeep(payload);\n      rootState.valueState.activatedInventory.forEach((item) => {\n        const itemDefinition = rootState.valueState.itemDefinitions[item];\n        if (itemDefinition !== undefined) {\n          itemDefinition.effects.forEach((effect) => {\n            switch (effect.effect) {\n              case ItemEffect.增加: {\n                if (realValue.score === effect.effectTo) {\n                  realValue.scoreDiff += effect.value;\n                }\n                break;\n              }\n              case ItemEffect.反转: {\n                if (realValue.score === effect.effectTo) {\n                  realValue.scoreDiff = -realValue.scoreDiff;\n                }\n                break;\n              }\n              case ItemEffect.转移: {\n                if (realValue.score === effect.effectFrom && effect.effectTo !== undefined) {\n                  realValue.score += effect.effectTo;\n                }\n                break;\n              }\n\n              default:\n                break;\n            }\n          });\n        }\n      });\n\n      return realValue;\n    },\n    selectGameEnding(payload, rootState) {\n      let currentEnding: IEnding | undefined;\n      console.info(rootState.valueState.scores);\n      rootState.valueState.endingDefinitions.forEach((ending) => {\n        const scoreKeys = Object.keys(ending.condition);\n        if (scoreKeys.every((key) => (rootState.valueState.scores[key] ?? 0) > ending.condition[key])) {\n          currentEnding = ending;\n        }\n      });\n      if (currentEnding !== undefined) {\n        dispatch.valueState.updateCurrentEnding(currentEnding);\n      } else {\n        console.error('没有找到合适的结局', rootState.valueState.scores, rootState.valueState.endingDefinitions);\n        dispatch.valueState.updateCurrentEnding({\n          name: '奇怪的结局',\n          description: '奇怪的是，在你下定决心的那一瞬间，图书馆层层剥落并崩塌了，仿佛这个世界的基石出了bug。',\n          condition: {},\n        });\n      }\n    },\n    insertUpdateInventory(itemName: string, rootState) {\n      const itemDefinition = rootState.valueState.itemDefinitions[itemName];\n      if (itemDefinition !== undefined) {\n        dispatch.uiState.currentItemCommentSetter(itemDefinition.comment);\n        dispatch.valueState.insertInventory(itemName);\n      }\n    },\n  }),\n});\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","/* eslint-disable @typescript-eslint/consistent-type-assertions */\nimport { createModel } from '@rematch/core';\nimport type { RootModel } from './index';\n\ninterface IUIState {\n  currentBookComment: string;\n  currentItemComment: string;\n  /**\n   * 当前在玩的背景故事\n   */\n  currentScenario: string;\n  guideText: string[];\n  /**\n   * 当前是否打开物品检视弹框\n   */\n  inventoryOpen: boolean;\n  /**\n   * 物品检视弹框里查看的物品\n   */\n  itemToInspect: string | undefined;\n  scenarios: Array<{ description: string; id: string; name: string }>;\n}\n\n/**\n * 管理UI和文案的状态\n */\nexport const uiState = createModel<RootModel>()({\n  state: {\n    currentScenario: 'alien',\n    currentBookComment: '',\n    currentItemComment: '',\n    scenarios: [\n      {\n        name: '评价地球文明的外星人',\n        id: 'alien',\n        description:\n          '你是一个来自其他文明的侦查员，通过量子爬虫爬取了地球的所有信息，生成了这座“图书馆”；你需要通过这些信息生成的书籍对地球文明进行评估，决定他们的命运...',\n      },\n    ],\n    guideText: [],\n    inventoryOpen: false,\n    itemToInspect: undefined,\n  } as IUIState,\n  reducers: {\n    guideTextSetter(state, guideText: string[]) {\n      state.guideText = guideText;\n      return state;\n    },\n    currentBookCommentSetter(state, currentBookComment: string) {\n      state.currentBookComment = currentBookComment;\n      return state;\n    },\n    currentItemCommentSetter(state, currentItemComment: string) {\n      state.currentItemComment = currentItemComment;\n      return state;\n    },\n    inspectItem(state, itemID: string) {\n      state.itemToInspect = itemID;\n      state.inventoryOpen = true;\n      return state;\n    },\n    closeInventoryInspectDialog(state) {\n      state.inventoryOpen = false;\n      return state;\n    },\n  },\n  effects: (dispatch) => ({\n    async loadGuideText(payload, rootState) {\n      const currentScenario = rootState.uiState.currentScenario;\n      const newGuideTextContent = await fetch(`data/${currentScenario}/guide.md`).then(async (response) => await response.text());\n      dispatch.uiState.guideTextSetter(newGuideTextContent.split('\\n'));\n    },\n  }),\n});\n","/* eslint-disable typescript-sort-keys/interface */\n/* eslint-disable @typescript-eslint/consistent-type-assertions */\nimport { random, sample, sampleSize } from 'lodash';\nimport { cddaJSONWithNameAndDescription, ICDDAJSONWithNameAndDescription } from 'cdda-chinese-text-dataset';\nimport { IConfiguration, templateFileToNLCSTNodes, getConfigSchemaFromTemplate, IOutputWIthMetadata, randomOutlineToArrayWithMetadataCompiler } from 'tbg';\nimport { createModel } from '@rematch/core';\nimport { VFile } from 'vfile';\nimport type { RootModel } from './index';\n\nconst parsedCddaJSONWithNameAndDescription = JSON.parse(cddaJSONWithNameAndDescription) as ICDDAJSONWithNameAndDescription[];\n\nexport interface IBookTextUpdateGameScoreMetadata {\n  /** 对哪个计分板进行加减分 */\n  score: string;\n  /** 正负值，正值为加分，反正直接加到现有分上就行 */\n  scoreDiff: number;\n}\nexport interface IBookTextNewItemMetadata {\n  /** 新获得的物品 ID */\n  item: string;\n}\n/**\n * 通过阅读书的某一行获得的新东西，可能是计分，也可能是物品/认知\n */\nexport type IBookTextMetadata = IBookTextUpdateGameScoreMetadata | IBookTextNewItemMetadata | (IBookTextUpdateGameScoreMetadata & IBookTextNewItemMetadata);\n\ninterface IBookState {\n  /** 要略读几本书才进入精读，一个范围用于随机选取 */\n  skimThroughReadCountRange: [number, number];\n  /** 略读的新书添加间隔 ms 时间 */\n  skimThroughReadInterval: number;\n  /** 精读时的计分板内容出率 */\n  detailedReadWithScoreFrequency: number;\n  /** 精读时的新物品出率 */\n  detailedReadWithItemFrequency: number;\n  /**\n   * 配置游戏里要精读几轮，一个范围用于随机选取\n   */\n  detailedReadRoundConfig: [number, number];\n  /**\n   * 配置每轮精读获取的数值的范围\n   */\n  newScoreRange: [number, number];\n  /**\n   * 当局游戏里随机出的需要精读几轮\n   */\n  detailedReadRound: number;\n  /**\n   * 当前已经读了几轮了\n   */\n  currentDetailedReadRound: number;\n  currentSkimThroughReadContent: ICDDAJSONWithNameAndDescription[];\n  currentDetailedReadTemplate: string | undefined;\n  currentDetailedReadContent: Array<IOutputWIthMetadata<IBookTextMetadata[]>>;\n  /**\n   * 目前游戏里可用的所有模板的目录\n   */\n  detailedTemplateMenu: string[];\n  /**\n   * 滑稽的对模板生成文本的评论\n   */\n  bookComments: Record<string, string>;\n  /**\n   * 当局精读里可用的随机抽取的几份模板的列表\n   */\n  currentDetailedTemplateNames: string[];\n}\n\n/**\n * 管理当前在读的书的状态\n */\nexport const bookState = createModel<RootModel>()({\n  state: {\n    skimThroughReadCountRange: [5, 15],\n    skimThroughReadInterval: 2000,\n    detailedReadWithScoreFrequency: 0.6,\n    detailedReadWithItemFrequency: 0.3,\n    detailedReadRoundConfig: [2, 5],\n    newScoreRange: [0, 6],\n    detailedReadRound: 3,\n    currentDetailedReadRound: 0,\n    currentSkimThroughReadContent: [],\n    currentDetailedReadTemplate: undefined,\n    currentDetailedReadContent: [],\n    detailedTemplateMenu: [],\n    bookComments: {},\n    currentDetailedTemplateNames: [],\n  } as IBookState,\n  reducers: {\n    /**\n     * 更新目前游戏里可用的所有模板的目录\n     */\n    updateDetailedTemplateMenu(state, newMenu: string[]) {\n      state.detailedTemplateMenu = newMenu;\n      return state;\n    },\n    /**\n     * 刷新当局游戏里随机出的需要精读几轮\n     * 顺便初始化当局游戏里已经读了几轮了\n     */\n    updateDetailedReadRound(state) {\n      const [min, max] = state.detailedReadRoundConfig;\n      state.detailedReadRound = random(min, max);\n      state.currentDetailedReadRound = 0;\n      return state;\n    },\n    /**\n     * 刷新当局游戏里已经读了几轮了\n     * 传 0 即为初始化\n     */\n    updateCurrentDetailedReadRound(state, currentDetailedReadRound: number) {\n      state.currentDetailedReadRound = currentDetailedReadRound;\n      return state;\n    },\n    /**\n     * 更新当局精读里可用的随机抽取的几份模板的列表\n     */\n    updateCurrentDetailedTemplateNames(state, newTemplateNames: string[]) {\n      state.currentDetailedTemplateNames = newTemplateNames;\n      return state;\n    },\n    clearSkimThroughReadingContent(state) {\n      state.currentSkimThroughReadContent = [];\n      return state;\n    },\n    appendSkimThroughReadingContent(state, newSkimThroughReadingContent: ICDDAJSONWithNameAndDescription) {\n      state.currentSkimThroughReadContent.push(newSkimThroughReadingContent);\n      return state;\n    },\n    clearDetailedReadingContent(state) {\n      state.currentDetailedReadContent = [];\n      return state;\n    },\n    updateDetailedReadingContent(state, newDetailedReadingContent: Array<IOutputWIthMetadata<IBookTextMetadata[]>>) {\n      state.currentDetailedReadContent = newDetailedReadingContent;\n      return state;\n    },\n    updateBookComments(state, newBookComments: Record<string, string>) {\n      state.bookComments = newBookComments;\n      return state;\n    },\n  },\n  effects: (dispatch) => ({\n    async startNewSkimThroughRead(payload, rootState) {\n      dispatch.bookState.clearSkimThroughReadingContent();\n      const [min, max] = rootState.bookState.skimThroughReadCountRange;\n      for (let counter = 0; counter < random(min, max); counter += 1) {\n        const randomBook = sample(parsedCddaJSONWithNameAndDescription);\n        if (randomBook !== undefined) {\n          dispatch.bookState.appendSkimThroughReadingContent(randomBook);\n          await new Promise((resolve) => setTimeout(resolve, rootState.bookState.skimThroughReadInterval));\n        } else {\n          console.error(`没有抽取到合适的书籍，可能 CDDA cddaJSONWithNameAndDescription 数据集有问题`);\n        }\n      }\n    },\n    /**\n     * 加载并抽取几本精读用的书备选\n     * @param count 抽几本书放在备选里\n     * @param rootState\n     * @returns\n     */\n    async loadAvailableDetailedTemplates(count: number, rootState) {\n      // 获取能用的模板\n      let detailedTemplateMenu = rootState.bookState.detailedTemplateMenu;\n      if (detailedTemplateMenu === undefined || detailedTemplateMenu.length === 0) {\n        const detailedTemplateMenuContent = await fetch('templates/menu.txt').then(async (response) => await response.text());\n        detailedTemplateMenu = detailedTemplateMenuContent.split('\\n');\n        dispatch.bookState.updateDetailedTemplateMenu(detailedTemplateMenu);\n      }\n      const newDetailedTemplateNames = sampleSize(detailedTemplateMenu, count);\n      if (newDetailedTemplateNames.length === 0) {\n        console.error(`没有抽取到合适的模板，可能 /public/templates/menu.txt 有问题`);\n        return;\n      }\n      dispatch.bookState.updateCurrentDetailedTemplateNames(newDetailedTemplateNames);\n    },\n    /**\n     * 选择好模板后，开始生成精读文本\n     * @param newDetailedTemplateName 要使用的模板名\n     * @param rootState\n     */\n    async startNewDetailedRead(newDetailedTemplateName: string, rootState) {\n      dispatch.bookState.clearDetailedReadingContent();\n      dispatch.bookState.updateCurrentDetailedTemplateNames([]);\n\n      const newDetailedTemplateContent = await fetch(`templates/${newDetailedTemplateName}`).then(async (response) => await response.text());\n      const vFile = new VFile({ path: newDetailedTemplateName, value: newDetailedTemplateContent });\n      // 开始自动生成\n      let newErrorMessage = '';\n      try {\n        const templateData = templateFileToNLCSTNodes(vFile);\n        // TODO: 暂时没用上模板槽位\n        const configFormData = {};\n        if (configFormData === undefined) {\n          throw new Error('模板参数不正确');\n        }\n\n        const result: Array<IOutputWIthMetadata<unknown[]>> = randomOutlineToArrayWithMetadataCompiler(templateData, configFormData);\n        // 为文本带上随机的数值内容\n        const scoreIDs = Object.keys(rootState.valueState.scores);\n        const itemIDs = Object.keys(rootState.valueState.itemDefinitions);\n        const resultWithRandomMetadata: Array<IOutputWIthMetadata<IBookTextMetadata[]>> = result.map((aResult) => {\n          // 每行文本都随机抽取一下\n          const randomScoreID = sample(scoreIDs);\n          const randomItemID = sample(itemIDs);\n          const haveScore = rootState.bookState.detailedReadWithScoreFrequency > random(0, 1, true);\n          const haveItem = rootState.bookState.detailedReadWithItemFrequency > random(0, 1, true);\n          let metadataItem: IBookTextMetadata | undefined;\n          if (haveScore && randomScoreID !== undefined) {\n            const [min, max] = rootState.bookState.newScoreRange;\n            const randomScoreValue = random(min, max);\n            metadataItem = {\n              ...metadataItem,\n              score: randomScoreID,\n              scoreDiff: randomScoreValue,\n            };\n          }\n          if (haveItem && randomItemID !== undefined) {\n            metadataItem = {\n              ...metadataItem,\n              item: randomItemID,\n            };\n          }\n          return {\n            ...aResult,\n            metadata: metadataItem !== undefined ? [metadataItem] : undefined,\n          };\n        });\n        dispatch.bookState.updateDetailedReadingContent(resultWithRandomMetadata);\n      } catch (error) {\n        newErrorMessage += (error as Error).message;\n      }\n      // newErrorMessage += reporter(vFile);\n      console.warn('自动生成结束', newErrorMessage);\n    },\n    /**\n     * 加载对书的评论到 uiState currentBookComment 里\n     * @param templateName 需要加载评论的书名\n     * @param rootState\n     */\n    async loadCurrentBookComment(templateName: string, rootState) {\n      let bookComments = rootState.bookState.bookComments;\n      if (Object.keys(bookComments).length === 0) {\n        const newBookCommentContent = await fetch(`templates/comment.json`).then(\n          async (response) => await (response.json() as Promise<Record<string, string>>),\n        );\n        dispatch.bookState.updateBookComments(newBookCommentContent);\n        bookComments = newBookCommentContent;\n      }\n      dispatch.uiState.currentBookCommentSetter(bookComments[templateName]);\n    },\n  }),\n});\n","import { Models } from '@rematch/core';\n\nimport { uiState } from './uiState';\nimport { bookState } from './bookState';\nimport { valueState } from './valueState';\n\nexport interface RootModel extends Models<RootModel> {\n  bookState: typeof bookState;\n  uiState: typeof uiState;\n  valueState: typeof valueState;\n}\n\nexport const models: RootModel = { uiState, bookState, valueState };\n","import { init, RematchDispatch, RematchRootState } from '@rematch/core';\nimport loadingPlugin, { ExtraModelsFromLoading } from '@rematch/loading';\nimport immerPlugin from '@rematch/immer';\n\nimport { models, RootModel } from './models';\n\ntype FullModel = ExtraModelsFromLoading<RootModel>;\nexport const store = init<RootModel, FullModel>({\n  models,\n  plugins: [immerPlugin(), loadingPlugin()],\n});\n\nexport type Store = typeof store;\nexport type Dispatch = RematchDispatch<RootModel>;\nexport type RootState = RematchRootState<RootModel, FullModel>;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { store } from './store/store';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.querySelector('#root'),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}